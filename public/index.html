<!DOCTYPE html>
<html>
	<head>
		<link rel="icon" href="https://nameless-taiga-88242.herokuapp.com/KOLuHYOrXW8T324wQ4OM.png">
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Weather API Data</title>
		<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
		<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
		<script src="/chart/dist/Chart.bundle.js"></script>
		<style>
			body {
				padding-top: 60px;
			}
		</style>		
		<script>
			function defaultCall(){				
				$.ajax({
						type: 'GET',
						url: '//api.wunderground.com/api/d95017df2847b211/conditions/forecast10day/history_20160822/q/94105.json',
						success: function(data) {	
						
							//Current Conditions
							$("#location").text(data.current_observation.observation_location.full);
							$("#temp_f").text(data.current_observation.temperature_string);
							$("#visibility_mi").text(data.current_observation.visibility_mi);
							$("#pressure_in").text(data.current_observation.pressure_in);
							$("#observation_time").text(data.current_observation.observation_time);
							$("#relative_humidity").text(data.current_observation.relative_humidity);
							$("#wind_string").text(data.current_observation.wind_string);
							
							var labelsForecast = [];
							var dataForecast = [];
							var labelsHistorical = [];
							var dataHistorical = [];
							
							for(var l=0; l<10; l++){
								dataForecast[l] = (data.forecast.simpleforecast.forecastday[l].high.fahrenheit);
								labelsForecast[l] = (data.forecast.simpleforecast.forecastday[l].date.month + "/" + data.forecast.simpleforecast.forecastday[l].date.day);
							}
							
							for(var l=0; l<27; l++){
								dataHistorical[l] = (data.history.observations[l].tempi);
								labelsHistorical[l] = (data.history.observations[l].date.hour + ":" + data.history.observations[l].date.min);
							}
							
							// Generate graph data
							var ctxForecast = document.getElementById("chartForecast").getContext("2d");
							ctxForecast.canvas.height = 50;
							var chartForecast = new Chart(ctxForecast , {
								responsive: 'true',
								type: 'line',
								data: { 
									labels: labelsForecast,
									datasets:[{
										label: 'Temp',
										data: dataForecast
									}]	
								},	
								options: {
									hover: {
										mode: 'label'
									},
									title: {
										display: true,
										text: '10 Day Forecast Conditions'
									},
									scales: {
										yAxes: [{
											ticks: {
												min: 55,
												max: 75
											}	
										}],
										xAxes: [{
											display: true
										}]
									}
								}
							});
							
							// Generate graph data
							var ctxHistorical = document.getElementById("chartHistorical").getContext("2d");
							ctxHistorical.canvas.height = 50;
							var chartHistorical = new Chart(ctxHistorical , {
								responsive: 'true',
								type: 'line',
								data: { 
									labels: labelsHistorical,
									datasets:[{
										label: 'Temp',
										data: dataHistorical
									}]	
								},	
								options: {
									hover: {
										mode: 'label'
									},
									title: {
										display: true,
										text: 'Historical Conditions (Previous Day - Hourly)'
									},
									scales: {
										yAxes: [{
											ticks: {
												min: 55,
												max: 75
											}	
										}],
										xAxes: [{
											display: true
										}]
									}
								}
							});
						}
					})
			}		
		</script>
	</head>
	<body onload = "defaultCall()">
		<nav class="navbar navbar-inverse navbar-fixed-top" style="width:100%; margin:center;">
			<div class="container" style="width:98%; margin:left;">
				<div class="navbar-header">
					<a class="navbar-brand" href="/">WUnderground Weather API Data</a>
				</div>
			</div>
		</nav>
		<div class="container" style="width:96%; margin:center;">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Current Conditions</h3>
				</div>
				<div class="panel-body" id="current">
					<div class="form-group" id="loc">
						<label for="location">Location:</label>
						<div id="location"></div>
					</div>
					<div class="form-group" id="tmp">
						<label for="temp_f">Temperature: </label>
						<div id="temp_f"></div>		
					</div>
					<div class="form-group" id="vis">
						<label for="visibility_mi">Visibility (MI): </label>
						<div id="visibility_mi"></div>
					</div>
					<div class="form-group" id="prs">
						<label for="pressure_in">Pressure (IN): </label>
						<div id="pressure_in"></div>
					</div>
					<div class="form-group" id="obs">
						<label for="observation_time">Last Update:</label>
						<div id="observation_time"></div>
					</div>
					<div class="form-group" id="hum">
						<label for="relative_humidity">Humidity: </label>
						<div id="relative_humidity"></div>
					</div>
					<div class="form-group" id="wnd">
						<label for="wind_string">Wind: </label>
						<div id="wind_string"></div>
					</div>				
				</div>
				<div class="panel-heading">
					<h3 class="panel-title">10 Day Forecast Conditions</h3>
				</div>
				<div class="panel-body" id="forecast">
					<label for="listpage1"></label>
					<div class="form-group" id="gv">
						<canvas id="chartForecast" width="100" height="100"></canvas>
					</div>
				</div>
				<div class="panel-heading">
					<h3 class="panel-title">Historical Conditions (Previous Day - Hourly)</h3>
				</div>
				<div class="panel-body" id="hist_graph">
					<label for="listpage1"></label>
					<div class="form-group" id="gv">
						<canvas id="chartHistorical" width="100" height="100"></canvas>
					</div>
				</div>				
			</div>
		</div>
	</body>
</html>